<!DOCTYPE html>
<html lang="en">
 
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Hola Vue</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    </head>
        
  <body>
    <div id="app">      
        <nav class="navbar navbar-light bg-info fixed-top">
          <span class="navbar-brand mb-0 h1">Hola 0048</span>
          <ul class="navbar-nav">
            <li class="navbar-item">
              <a class="nav-link" href="#">{{cart}}</a>
            </li>
          </ul>
        </nav>
        <div class="container pt-4">      
          <product @add-to-cart="addToCart" @remove-from-cart="removeFromCart"></product>      
        </div>
    </div>
      <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>  
    <script type="text/x-template" id="template-product">
       <div class="row pt-5">
          <div class="col-12 col-md-6">
              <img v-bind:src="img"   width="100%">           
          </div>
          <div class="col-12 col-md-6">
            <h1>{{ product }} </h1>
            <h2>{{ description}}</h2>
            <h4>{{stock}}</h4>
            <p v-if='stock>10'> en stock</p>
            <p v-else-if= 'stock <= 10 && stock > 0'>quedan muy pocas </p>
            <p v-else>Agotadas</p>
              <ul>
                <li v-for='(detail, index) in details' :key="index">{{detail}}</li>
              </ul>
              <div v-for='variant in variants' :key='variant.id'>
                <p v-on:mouseover='updateProduct(variant)'>{{variant.type}}</p>
              </div>
            <a :href="link">ver</a>            
            <button class="btn btn-sm btn-info" @click='addToCart' :disabled="!inStock"> agragar  al carro</button>
            <button class="btn btn-sm btn-warning" @click='removeFromCart'>Sacar del carro</button>
          </div>
    </div>

    </script>  
  </body>    
</html>

<script>
Vue.component ("product", { //primero dos argumentos el nombre del componente y obejto (vacio) segundo argumento
data() {
  return{
          description:'loren ipsum',
          product: 'Longaniza de Brocolli',
          selectedVariant: {},
          link:'./longaniza.html',
          details: ["500 gr", "organica", "libre de colesterol"],
          variants:[{
              id:5,
              type:'red',
              img: 'assets/roja.jpeg',
              stock:10,
              default: true
          },
          {
              id:4,
              type:'white',
              img: 'assets/blanca.png',
              stock: 0
            }
        ],
      }
},
  methods: {
          updateProduct(variant) {
            this.selectedVariant=variant;
        },
        addToCart(){
         this.$emit("add-too-cart", 1)
          this.selectedVariant.stock-=1
        },
        removeFromCart(){           
            this.$emit("remove-from-cart", 1);
            this.selectedVariant.stock+=1          
        }
      },

  computed: {
        inStock(){
           return this.stock>0 ? true :false //retornar el stock >0 ? (if) es verdadero : (si no)  es falso 
        },
        img(){
          return this.selectedVariant.img
        },
        stock(){
          return this.selectedVariant.stock
        }
      },
      created() {
        
        this.selectedVariant= this.variants.find(item => item.default ==true)
        
      },

  template: '#template-product'
  
  })
    var app = new Vue({
        el: '#app',
        data:{
          cart:0,
        },

        methods: {//los metodos se pueden separar con mayusculas
          addToCart(cantidad){
            this.cart +=cantidad;

          },
          removeFromCart(cantidad){
            if(this.cart > 0){
            this.cart -=cantidad;
            }
          }

        }       
    })

    </script>